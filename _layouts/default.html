<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      {% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}
    </title>
    <meta
      name="description"
      content="{{ page.description | default: site.description }}"
    />

    <!-- SEO Meta Tags -->
    <meta
      property="og:title"
      content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}"
    />
    <meta
      property="og:description"
      content="{{ page.description | default: site.description }}"
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ site.url }}{{ page.url }}" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}"
    />
    <meta
      name="twitter:description"
      content="{{ page.description | default: site.description }}"
    />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}" />

    <!-- Theme Initialization -->
    <script>
      // Initialize theme before page renders to prevent flash
      (function () {
        const configTheme = '{{ site.theme_color | default: "clean" }}';
        const savedTheme = localStorage.getItem("portfolio-theme");
        const theme = savedTheme || configTheme;

        // Apply to both html and body elements for stronger CSS targeting
        document.documentElement.className = `theme-${theme}`;
        document.documentElement.setAttribute("data-theme", theme);
      })();
    </script>
  </head>
  <body
    class="theme-{{ site.theme_color | default: 'clean' }}"
    data-config-theme="{{ site.theme_color | default: 'clean' }}"
  >
    <!-- Main Content Wrapper -->
    <div class="page-wrapper">
      <main class="main-content">{{ content }}</main>

      <!-- Fixed Footer -->
      <footer class="site-footer">
        <div class="footer-container">
          <div class="footer-content">
            <div class="footer-icon">
              {% if site.footer_logo %}
              <img
                src="{{ site.footer_logo | relative_url }}"
                alt="{{ site.company_name | default: 'Company Logo' }}"
                class="footer-logo-img"
                onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-block';"
              />
              {% endif %} {% if site.company_url %}
              <a
                href="{{ site.company_url }}"
                target="_blank"
                rel="noopener"
                class="footer-icon-fallback"
                {%
                if
                site.footer_logo
                %}style="display: none;"
                {%
                endif
                %}
              >
                <i class="fas fa-rocket"></i>
              </a>
              {% else %}
              <i
                class="fas fa-rocket footer-icon-fallback"
                {%
                if
                site.footer_logo
                %}style="display: none;"
                {%
                endif
                %}
              ></i>
              {% endif %}
            </div>
            <p class="footer-text">
              Powered by {% if site.company_url %}
              <a href="{{ site.company_url }}" target="_blank" rel="noopener"
                >{{ site.company_name | default: "Jekyll" }}</a
              >
              {% else %} {{ site.company_name | default: "Jekyll" }} {% endif %}
            </p>
          </div>
        </div>
      </footer>
    </div>

    <!-- Main JavaScript -->
    <script src="{{ '/assets/js/main.js' | relative_url }}"></script>

    <!-- Analytics (if configured) -->
    {% if site.google_analytics %}
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "{{ site.google_analytics }}");
    </script>
    {% endif %}

    <style>
      /* FIXED: Page layout and footer positioning */
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
      }

      .page-wrapper {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .main-content {
        flex: 1;
      }

      /* FIXED: Footer stays at bottom */
      .site-footer {
        background: var(--bg-primary, #ffffff);
        border-top: 1px solid var(--border-color, #e5e7eb);
        padding: 30px 0;
        text-align: center;
        margin-top: auto;
        flex-shrink: 0;
      }

      .footer-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      .footer-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
      }

      /* FIXED: Footer logo styling */
      .footer-icon {
        margin-bottom: 5px;
        position: relative;
      }

      .footer-logo-img {
        height: 40px;
        width: auto;
        max-width: 120px;
        border-radius: 8px;
        transition: all 0.4s ease;
        filter: drop-shadow(0 0 10px rgba(249, 115, 22, 0.3));
      }

      .footer-logo-img:hover {
        transform: scale(1.05);
        filter: drop-shadow(0 0 20px rgba(249, 115, 22, 0.6));
      }

      .footer-icon-fallback,
      .footer-icon-fallback i {
        font-size: 2.2rem;
        color: var(--primary-color, #f97316);
        transition: all 0.4s ease;
        filter: drop-shadow(0 0 10px rgba(249, 115, 22, 0.3));
        text-decoration: none;
      }

      .footer-icon-fallback:hover,
      .footer-icon-fallback i:hover {
        transform: scale(1.1) rotate(5deg);
        filter: drop-shadow(0 0 20px rgba(249, 115, 22, 0.6));
        color: var(--primary-dark, #ea580c);
      }

      .footer-text {
        margin: 0;
        color: var(--text-muted, #9ca3af);
        font-size: 0.9rem;
      }

      .footer-text a {
        color: var(--primary-color, #f97316);
        text-decoration: none;
        transition: color 0.3s ease;
      }

      .footer-text a:hover {
        color: var(--primary-dark, #ea580c);
        text-decoration: underline;
      }

      @media (max-width: 768px) {
        .footer-logo-img {
          height: 35px;
        }

        .footer-icon-fallback,
        .footer-icon-fallback i {
          font-size: 2rem;
        }

        .site-footer {
          padding: 25px 0;
        }

        .footer-text {
          font-size: 0.8rem;
        }
      }

      /* Theme transition for smooth switching */
      body {
        transition: background-color 0.3s ease, color 0.3s ease;
      }

      /* Dark theme specific styles */
      body[data-theme="dark"] {
        background: var(--bg-primary, #111827);
        color: var(--text-primary, #f9fafb);
      }

      body[data-theme="dark"] .site-footer {
        background: var(--bg-secondary, #1f2937);
        border-top-color: var(--border-color, #374151);
      }
    </style>
  </body>
</html>
